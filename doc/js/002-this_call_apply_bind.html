<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>this、call、apply、bind | 知识库</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="🖖小型前端知识库🖖">
    <link rel="preload" href="/blog-demo/assets/css/0.styles.8f26d5a6.css" as="style"><link rel="preload" href="/blog-demo/assets/js/app.d550568f.js" as="script"><link rel="preload" href="/blog-demo/assets/js/2.9eb2f958.js" as="script"><link rel="preload" href="/blog-demo/assets/js/16.36be232d.js" as="script"><link rel="prefetch" href="/blog-demo/assets/js/10.0efb48ae.js"><link rel="prefetch" href="/blog-demo/assets/js/11.284cf3a4.js"><link rel="prefetch" href="/blog-demo/assets/js/12.2e730a1a.js"><link rel="prefetch" href="/blog-demo/assets/js/13.4cbdbc29.js"><link rel="prefetch" href="/blog-demo/assets/js/14.a5dcba57.js"><link rel="prefetch" href="/blog-demo/assets/js/15.12c8c0fe.js"><link rel="prefetch" href="/blog-demo/assets/js/17.a71abff2.js"><link rel="prefetch" href="/blog-demo/assets/js/18.ff8b777b.js"><link rel="prefetch" href="/blog-demo/assets/js/19.76db4b73.js"><link rel="prefetch" href="/blog-demo/assets/js/20.fad1c0c9.js"><link rel="prefetch" href="/blog-demo/assets/js/21.4d7e21b9.js"><link rel="prefetch" href="/blog-demo/assets/js/22.b8c0287c.js"><link rel="prefetch" href="/blog-demo/assets/js/23.722d8536.js"><link rel="prefetch" href="/blog-demo/assets/js/24.ce2394c7.js"><link rel="prefetch" href="/blog-demo/assets/js/25.851351ef.js"><link rel="prefetch" href="/blog-demo/assets/js/26.1bf51354.js"><link rel="prefetch" href="/blog-demo/assets/js/27.f7cd5aec.js"><link rel="prefetch" href="/blog-demo/assets/js/28.a119db7c.js"><link rel="prefetch" href="/blog-demo/assets/js/29.2cc7ce5b.js"><link rel="prefetch" href="/blog-demo/assets/js/3.71704d6a.js"><link rel="prefetch" href="/blog-demo/assets/js/30.b5b34706.js"><link rel="prefetch" href="/blog-demo/assets/js/31.ea3bc06a.js"><link rel="prefetch" href="/blog-demo/assets/js/32.279d9880.js"><link rel="prefetch" href="/blog-demo/assets/js/33.17366f3a.js"><link rel="prefetch" href="/blog-demo/assets/js/34.228aaca8.js"><link rel="prefetch" href="/blog-demo/assets/js/35.f565841d.js"><link rel="prefetch" href="/blog-demo/assets/js/36.fcbf67df.js"><link rel="prefetch" href="/blog-demo/assets/js/37.136c79a0.js"><link rel="prefetch" href="/blog-demo/assets/js/38.d16994ee.js"><link rel="prefetch" href="/blog-demo/assets/js/39.0958ecda.js"><link rel="prefetch" href="/blog-demo/assets/js/4.ed4e2359.js"><link rel="prefetch" href="/blog-demo/assets/js/40.e63dfa5a.js"><link rel="prefetch" href="/blog-demo/assets/js/41.67123acc.js"><link rel="prefetch" href="/blog-demo/assets/js/42.0568441c.js"><link rel="prefetch" href="/blog-demo/assets/js/43.95ff9579.js"><link rel="prefetch" href="/blog-demo/assets/js/44.7b93a1e3.js"><link rel="prefetch" href="/blog-demo/assets/js/45.94bb121b.js"><link rel="prefetch" href="/blog-demo/assets/js/46.4e956d24.js"><link rel="prefetch" href="/blog-demo/assets/js/47.da5f967a.js"><link rel="prefetch" href="/blog-demo/assets/js/48.21d018d6.js"><link rel="prefetch" href="/blog-demo/assets/js/49.f9355e98.js"><link rel="prefetch" href="/blog-demo/assets/js/5.5d7cadc2.js"><link rel="prefetch" href="/blog-demo/assets/js/50.907acd5d.js"><link rel="prefetch" href="/blog-demo/assets/js/51.2dc13f47.js"><link rel="prefetch" href="/blog-demo/assets/js/6.4b76c2b0.js"><link rel="prefetch" href="/blog-demo/assets/js/7.e5f89a61.js"><link rel="prefetch" href="/blog-demo/assets/js/8.95e64e48.js"><link rel="prefetch" href="/blog-demo/assets/js/9.abb57db4.js">
    <link rel="stylesheet" href="/blog-demo/assets/css/0.styles.8f26d5a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog-demo/" class="home-link router-link-active"><!----> <span class="site-name">知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/blog-demo/doc/js/" aria-current="page" class="sidebar-link">js部分</a></li><li><a href="/blog-demo/doc/js/001-对象原型继承.html" class="sidebar-link">对象原型继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_1-构造函数-js的类" class="sidebar-link">1. 构造函数:JS的类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_1-1-使用new命令生成一个对象" class="sidebar-link">1.1 使用new命令生成一个对象</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_1-2-object-create-创建实例对象" class="sidebar-link">1.2 Object.create() 创建实例对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_2-原型对象的概述" class="sidebar-link">2. 原型对象的概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_2-1-构造函数的缺点" class="sidebar-link">2.1 构造函数的缺点</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_2-2-函数的prototype属性的作用" class="sidebar-link">2.2 函数的prototype属性的作用</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_2-3-原型链" class="sidebar-link">2.3 原型链</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_2-4-constructor属性" class="sidebar-link">2.4 constructor属性</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_3-构造函数的继承" class="sidebar-link">3. 构造函数的继承</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_4-多重继承" class="sidebar-link">4. 多重继承</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#_5-instanceof运算符-判断对象的类型" class="sidebar-link">5. instanceof运算符:判断对象的类型</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/001-对象原型继承.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/002-this_call_apply_bind.html" aria-current="page" class="active sidebar-link">this、call、apply、bind</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_1-什么是this" class="sidebar-link">1. 什么是this</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_2-不同环境下this的指向" class="sidebar-link">2. 不同环境下this的指向</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_2-1-全局环境：this指向顶层对象window" class="sidebar-link">2.1 全局环境：this指向顶层对象window</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_2-2-构造函数：this指向实例对象" class="sidebar-link">2.2 构造函数：this指向实例对象</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_2-3-对象的方法中-a-b-c-this指向a-b" class="sidebar-link">2.3 对象的方法中(a.b.c()):this指向a.b</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_3-使用this注意点" class="sidebar-link">3. 使用this注意点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_3-1-避免多层this" class="sidebar-link">3.1 避免多层this</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_3-2-避免数组处理方法中的this" class="sidebar-link">3.2 避免数组处理方法中的this</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_3-3-避免回调函数中的this" class="sidebar-link">3.3 避免回调函数中的this</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_4-绑定this的方法" class="sidebar-link">4. 绑定this的方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_4-1-function-prototype-call" class="sidebar-link">4.1 Function.prototype.call()</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_4-2-function-prototype-apply" class="sidebar-link">4.2 Function.prototype.apply()</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#_4-3-function-prototype-bind" class="sidebar-link">4.3 Function.prototype.bind()</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/002-this_call_apply_bind.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/003-数据类型转换.html" class="sidebar-link">数据类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_1-概述" class="sidebar-link">1. 概述</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-强制类型转换" class="sidebar-link">2. 强制类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-1-其他类型转数字的规则" class="sidebar-link">2.1 其他类型转数字的规则</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-2-其他类型转字符串规则" class="sidebar-link">2.2 其他类型转字符串规则</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-3-其他类型转布尔规则" class="sidebar-link">2.3 其他类型转布尔规则</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-4-强制转为数字方法：number-、parseint-、parsefloat-string" class="sidebar-link">2.4 强制转为数字方法：Number()、parseInt()、parseFloat(string)</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-5-强制转换为字符串方法：string-value" class="sidebar-link">2.5 强制转换为字符串方法：String(value)</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_2-6-强转为布尔方法：boolean" class="sidebar-link">2.6 强转为布尔方法：Boolean()</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_3-自动类型转换" class="sidebar-link">3. 自动类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_3-1-出现自动类型转换的情况" class="sidebar-link">3.1 出现自动类型转换的情况</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_3-2-非严格判断相等的转换规则" class="sidebar-link">3.2 ==非严格判断相等的转换规则</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_3-2-自动转换为布尔值" class="sidebar-link">3.2 自动转换为布尔值</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_3-3-自动转换为字符串" class="sidebar-link">3.3 自动转换为字符串</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#_3-4-自动转换为数值" class="sidebar-link">3.4 自动转换为数值</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/003-数据类型转换.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/004-跨域.html" class="sidebar-link">跨域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#浏览器阻止跨域的目的" class="sidebar-link">浏览器阻止跨域的目的</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#跨域介绍" class="sidebar-link">跨域介绍</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#同源策略-same-origin-policy" class="sidebar-link">同源策略(Same origin Policy)</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#一个跨域的例子" class="sidebar-link">一个跨域的例子</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#如何进行跨域访问？" class="sidebar-link">如何进行跨域访问？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#使用jsonp来实现跨域访问" class="sidebar-link">使用JSONP来实现跨域访问</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#cors-跨域资源共享（cross-origin-resource-sharing）" class="sidebar-link">CORS 跨域资源共享（Cross-Origin Resource Sharing）</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#iframe跨域方法" class="sidebar-link">iframe跨域方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#降域：document-domain" class="sidebar-link">降域：document.domain</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#window-postmessage页面通信" class="sidebar-link">window.postMessage页面通信</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/004-跨域.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/005-Ajax.html" class="sidebar-link">Ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/005-Ajax.html#使用xmlhttprequest实现ajax" class="sidebar-link">使用XMLHttpRequest实现Ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/005-Ajax.html#使用xmlhttprequest-发一个请求" class="sidebar-link">使用XMLHTTPRequest()发一个请求</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/005-Ajax.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/blog-demo/doc/js/006-函数.html" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_1-函数介绍" class="sidebar-link">1. 函数介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_1-1-函数的三种声明" class="sidebar-link">1.1 函数的三种声明</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_1-2-函数的重复声明：后面覆盖前面" class="sidebar-link">1.2 函数的重复声明：后面覆盖前面</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_1-3-函数调用、return语句、调用自身、函数是一种值" class="sidebar-link">1.3 函数调用、return语句、调用自身、函数是一种值</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_1-4-函数名提升" class="sidebar-link">1.4 函数名提升</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_2-函数的属性和方法" class="sidebar-link">2. 函数的属性和方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#_2-1-name属性" class="sidebar-link">2.1 name属性</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/006-函数.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/007-作用域.html" class="sidebar-link">作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_1-什么是作用域？" class="sidebar-link">1. 什么是作用域？</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_2-为什么需要作用域？最小访问原则" class="sidebar-link">2. 为什么需要作用域？最小访问原则</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_3-javascript中的作用域" class="sidebar-link">3. JavaScript中的作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_3-1-全局作用域" class="sidebar-link">3.1 全局作用域</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_3-2-局部作用域" class="sidebar-link">3.2 局部作用域</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_3-3-块语句" class="sidebar-link">3.3 块语句</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_3-4-作用域生存周期" class="sidebar-link">3.4 作用域生存周期</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_4-上下文" class="sidebar-link">4. 上下文</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_5-执行环境" class="sidebar-link">5. 执行环境</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_6-创建阶段" class="sidebar-link">6 创建阶段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_6-1-变量对象" class="sidebar-link">6.1 变量对象</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_6-2-作用域链" class="sidebar-link">6.2 作用域链</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_6-3-执行环境对象" class="sidebar-link">6.3 执行环境对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_7-代码执行阶段" class="sidebar-link">7. 代码执行阶段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_7-1-词法作用域" class="sidebar-link">7.1 词法作用域</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_7-2-闭包" class="sidebar-link">7.2 闭包</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_8-共有作用域和私有作用域" class="sidebar-link">8. 共有作用域和私有作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_8-1-模块模式" class="sidebar-link">8.1 模块模式</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_8-2-立即执行函数表达式（iife）" class="sidebar-link">8.2 立即执行函数表达式（IIFE）</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#_9-使用-call-，-apply-和-bind-改变上下文" class="sidebar-link">9. 使用 .call()， .apply() 和 .bind() 改变上下文</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/007-作用域.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/008-排序算法.html" class="sidebar-link">排序算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/008-排序算法.html#_1-冒泡排序" class="sidebar-link">1. 冒泡排序</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/008-排序算法.html#_2-快读排序" class="sidebar-link">2. 快读排序</a></li></ul></li><li><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html" class="sidebar-link">获取标签的宽高及例子</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_1-常用的获取宽高的属性" class="sidebar-link">1. 常用的获取宽高的属性</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_2-关于offset的5个属性" class="sidebar-link">2. 关于offset的5个属性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_2-1-offsetwidth与offsetheight" class="sidebar-link">2.1 offsetWidth与offsetHeight</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_2-3-offsetleft与offsettop" class="sidebar-link">2.3 offsetLeft与offsetTop</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_2-4-offsetparent" class="sidebar-link">2.4 offsetParent</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_3-关于宽高的实际应用" class="sidebar-link">3. 关于宽高的实际应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_3-1-判断滚动条到底的条件" class="sidebar-link">3.1 判断滚动条到底的条件</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_3-2-js判断div内离开顶部，-设置滚动到指定位置，-判断滚动到达底部：" class="sidebar-link">3.2 JS判断div内离开顶部， 设置滚动到指定位置， 判断滚动到达底部：</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_3-3-获取浏览器窗口宽度" class="sidebar-link">3.3 获取浏览器窗口宽度</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_4-document-compatmode对获取浏览器窗口大小的影响" class="sidebar-link">4. document.compatMode对获取浏览器窗口大小的影响</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_4-1-backcompat：-浏览器高度使用body的值" class="sidebar-link">4.1 BackCompat： 浏览器高度使用body的值</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_4-2-css1compat：浏览器高度使用documentelement的值" class="sidebar-link">4.2 CSS1Compat：浏览器高度使用documentElement的值</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_4-3-doctype-会影响document-compatmode" class="sidebar-link">4.3 DOCTYPE 会影响document.compatMode</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_4-4-documentelement和body" class="sidebar-link">4.4 documentElement和body</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_5-浏览器兼容性问题" class="sidebar-link">5. 浏览器兼容性问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_5-1-各浏览器下-scrolltop的差异" class="sidebar-link">5.1 各浏览器下 scrollTop的差异</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_6-一些问题" class="sidebar-link">6. 一些问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_6-1-document-body-scrolltop总是0的原因" class="sidebar-link">6.1 document.body.scrollTop总是0的原因</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#_6-2-给body标签设置高度后，显示的效果是一实际高度算的" class="sidebar-link">6.2 给body标签设置高度后，显示的效果是一实际高度算的</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/009-获取标签宽高及实例.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html" class="sidebar-link">从输入URL到页面渲染过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_1-url解析" class="sidebar-link">1. URL解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_1-1-地址解析" class="sidebar-link">1.1 地址解析</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_1-2-hsts" class="sidebar-link">1.2 HSTS</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_1-3-其他操作" class="sidebar-link">1.3 其他操作</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_1-4-缓存检查" class="sidebar-link">1.4 缓存检查</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_2-dns查询" class="sidebar-link">2. DNS查询</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_3-tcp链接" class="sidebar-link">3. TCP链接</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_3-1-tcp-ip分层" class="sidebar-link">3.1 TCP/IP分层</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_3-2-tcp三次握手建立连接" class="sidebar-link">3.2 TCP三次握手建立连接</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_3-3-tcp四次挥手断开连接" class="sidebar-link">3.3 TCP四次挥手断开连接</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_4-服务器处理请求" class="sidebar-link">4. 服务器处理请求</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_5-浏览器接受响应" class="sidebar-link">5. 浏览器接受响应</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-渲染页面" class="sidebar-link">6. 渲染页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-1-浏览器内核、渲染流程" class="sidebar-link">6.1 浏览器内核、渲染流程</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-2-html解析" class="sidebar-link">6.2 HTML解析</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-3-css解析" class="sidebar-link">6.3 CSS解析</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-4-生成渲染树" class="sidebar-link">6.4 生成渲染树</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-5-布局、绘制、渲染" class="sidebar-link">6.5 布局、绘制、渲染</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_6-6-回流与重绘" class="sidebar-link">6.6 回流与重绘</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_7-javascript-编译执行" class="sidebar-link">7. JavaScript 编译执行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_7-1-词法分析" class="sidebar-link">7.1 词法分析</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_7-2-预编译" class="sidebar-link">7.2 预编译</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#_7-3-执行" class="sidebar-link">7.3 执行</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/010-从输入URL到页面渲染过程.html#参考资料：" class="sidebar-link">参考资料：</a></li></ul></li><li><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html" class="sidebar-link">JavaScript浮点数运算的精度问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_1-js中浮点数运算问题" class="sidebar-link">1. JS中浮点数运算问题</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_2-问题原因" class="sidebar-link">2. 问题原因</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_3-计算过程" class="sidebar-link">3. 计算过程</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_4-整数的精度问题" class="sidebar-link">4. 整数的精度问题</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_5-解决方案" class="sidebar-link">5. 解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_5-1-第三方类库" class="sidebar-link">5.1 第三方类库</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_5-2-整数表示" class="sidebar-link">5.2 整数表示</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_6-格式化数字、金额、保留几位小数等" class="sidebar-link">6 格式化数字、金额、保留几位小数等</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_7-浮点数运算解决方法" class="sidebar-link">7. 浮点数运算解决方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_7-1-tofixed-方法" class="sidebar-link">7.1 toFixed() 方法</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_7-2-加法函数" class="sidebar-link">7.2 加法函数</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_7-3-减法函数" class="sidebar-link">7.3 减法函数</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_7-4-乘法函数" class="sidebar-link">7.4 乘法函数</a></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#_7-5-除法函数" class="sidebar-link">7.5 除法函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog-demo/doc/js/013-JS浮点数运算的精度问题.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS代码执行机制和事件循环</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>高级</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>文章</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#_1-什么是this">1. 什么是this</a></li><li><a href="#_2-不同环境下this的指向">2. 不同环境下this的指向</a><ul><li><a href="#_2-1-全局环境：this指向顶层对象window">2.1 全局环境：this指向顶层对象window</a></li><li><a href="#_2-2-构造函数：this指向实例对象">2.2 构造函数：this指向实例对象</a></li><li><a href="#_2-3-对象的方法中-a-b-c-this指向a-b">2.3 对象的方法中(a.b.c()):this指向a.b</a></li></ul></li><li><a href="#_3-使用this注意点">3. 使用this注意点</a><ul><li><a href="#_3-1-避免多层this">3.1 避免多层this</a></li><li><a href="#_3-2-避免数组处理方法中的this">3.2 避免数组处理方法中的this</a></li><li><a href="#_3-3-避免回调函数中的this">3.3 避免回调函数中的this</a></li></ul></li><li><a href="#_4-绑定this的方法">4. 绑定this的方法</a><ul><li><a href="#_4-1-function-prototype-call">4.1 Function.prototype.call()</a></li><li><a href="#_4-2-function-prototype-apply">4.2 Function.prototype.apply()</a></li><li><a href="#_4-3-function-prototype-bind">4.3 Function.prototype.bind()</a></li></ul></li><li><a href="#参考资料">参考资料</a></li></ul></div><p></p> <p>[TOC]</p> <h1 id="this、call、apply、bind"><a href="#this、call、apply、bind" class="header-anchor">#</a> this、call、apply、bind</h1> <h2 id="_1-什么是this"><a href="#_1-什么是this" class="header-anchor">#</a> 1. 什么是this</h2> <p>使用this会返回一个对象。也就是说：this就是属性或方法当前所在的对象。</p> <p>由于对象的属性可以赋值(复制一份)给另一个对象,所以属性所在的当前对象是可变，即this的指向是可变的：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'jack'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'aimi'</span><span class="token punctuation">}</span>
<span class="token constant">B</span><span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">.</span>say<span class="token punctuation">;</span>
<span class="token constant">B</span><span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// &quot;hello aimi&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>A.say属性赋值给B.t,所以this.name就指向B.name,类似于下面：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'aimi'</span><span class="token punctuation">}</span>
<span class="token constant">B</span><span class="token punctuation">.</span>t <span class="token operator">=</span> f<span class="token punctuation">;</span>
<span class="token constant">B</span><span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>只要函数被赋给另一个变量，<code>this</code>的指向就会变:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'jack'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'huawei'</span>
<span class="token keyword">var</span> tmp <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">.</span>say<span class="token punctuation">;</span>
<span class="token function">tmp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// hello huawei</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>在JavaScript语言中，一切皆对象，运行环境也是对象，所以函数都是在某个对象之中运行，this就是函数运行时所在的对象(环境)。</p> <h2 id="_2-不同环境下this的指向"><a href="#_2-不同环境下this的指向" class="header-anchor">#</a> 2. 不同环境下this的指向</h2> <h3 id="_2-1-全局环境：this指向顶层对象window"><a href="#_2-1-全局环境：this指向顶层对象window" class="header-anchor">#</a> 2.1 全局环境：this指向顶层对象window</h3> <h3 id="_2-2-构造函数：this指向实例对象"><a href="#_2-2-构造函数：this指向实例对象" class="header-anchor">#</a> 2.2 构造函数：this指向实例对象</h3> <h3 id="_2-3-对象的方法中-a-b-c-this指向a-b"><a href="#_2-3-对象的方法中-a-b-c-this指向a-b" class="header-anchor">#</a> 2.3 对象的方法中(a.b.c()):this指向a.b</h3> <p>如果对象的方法里面包含this，那么this指向的就是方法运行时所在的对象。该方法赋值(复制)给另一个对象，就会改变this的指向。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// obj.foo方法执行时，它内部的this指向obj。</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// obj</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>但，下面这几种用法都会改变this的指向：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 情况一</span>
<span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
<span class="token comment">// 情况二</span>
<span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">||</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
<span class="token comment">// 情况三</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>obj.foo</code>就是一个值，这个值真正调用的时候，运行环境已经不是<code>obj</code>了，而是全局环境，所以this不在指向<code>obj</code>。</p> <p>可以这样理解，<code>obj</code>和<code>obj.foo</code>储存在两个内存地址，称为地址一和地址二。<code>obj.foo()</code>这样调用时，是从地址一调用地址二，因此地址二的运行环境是地址一，<code>this</code>指向<code>obj</code>。但是，上面三种情况，都是直接取出地址二进行调用，这样的话，运行环境就是全局环境，因此<code>this</code>指向全局环境。上面三种情况等同于下面的代码。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 情况一</span>
<span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 情况二</span>
<span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">||</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 情况三</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_3-使用this注意点"><a href="#_3-使用this注意点" class="header-anchor">#</a> 3. 使用this注意点</h2> <h3 id="_3-1-避免多层this"><a href="#_3-1-避免多层this" class="header-anchor">#</a> 3.1 避免多层this</h3> <p>由于<code>this</code>的指向是不确定的，所以切勿在函数中包含多层的<code>this</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">f1</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">f2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
o<span class="token punctuation">.</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Object</span>
<span class="token comment">// Window</span>
<span class="token comment">// 上面代码包含两层this，结果运行后，第一层指向对象o，第二层指向全局对象，因为实际执行的是下面的代码。</span>
<span class="token keyword">var</span> <span class="token function-variable function">temp</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">f1</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> f2 <span class="token operator">=</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 解决方法是在第二层改用一个指向外层this的变量。</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">f1</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">f2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>JavaScript 提供了严格模式，也可以硬性避免这种问题。严格模式下，如果函数内部的<code>this</code>指向顶层对象，就会报错。</p> <h3 id="_3-2-避免数组处理方法中的this"><a href="#_3-2-避免数组处理方法中的this" class="header-anchor">#</a> 3.2 避免数组处理方法中的this</h3> <p>数组的<code>map</code>和<code>foreach</code>方法，允许提供一个函数作为参数。这个函数内部不应该使用<code>this</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  v<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> p<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'a1'</span><span class="token punctuation">,</span> <span class="token string">'a2'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">f</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>p<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>v <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
o<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// undefined a1</span>
<span class="token comment">// undefined a2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上面代码中，<code>foreach</code>方法的回调函数中的<code>this</code>，其实是指向<code>window</code>对象，因此取不到<code>o.v</code>的值。原因跟上一段的多层<code>this</code>是一样的，就是内层的<code>this</code>不指向外部，而指向顶层对象。</p> <p>解决这个问题的一种方法，就是前面提到的，使用中间变量固定<code>this</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  v<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> p<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'a1'</span><span class="token punctuation">,</span> <span class="token string">'a2'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">f</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>p<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>v<span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
o<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// hello a1</span>
<span class="token comment">// hello a2</span>

<span class="token comment">// 另一种方法是将this当作foreach方法的第二个参数，固定它的运行环境。</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  v<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> p<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'a1'</span><span class="token punctuation">,</span> <span class="token string">'a2'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">f</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>p<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>v <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
o<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// hello a1</span>
<span class="token comment">// hello a2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_3-3-避免回调函数中的this"><a href="#_3-3-避免回调函数中的this" class="header-anchor">#</a> 3.3 避免回调函数中的this</h3> <p>回调函数中的<code>this</code>往往会改变指向，最好避免使用。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span><span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment">// jQuery 的写法</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> o<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面代码中，点击按钮以后，控制台会显示<code>false</code>。原因是此时<code>this</code>不再指向<code>o</code>对象，而是指向按钮的 DOM 对象，因为<code>f</code>方法是在按钮对象的环境中被调用的。这种细微的差别，很容易在编程中忽视，导致难以察觉的错误。</p> <p>为了解决this不定问题，可以使用一些方法对this进行绑定，也就是固定this指向，减少不确定性。</p> <h2 id="_4-绑定this的方法"><a href="#_4-绑定this的方法" class="header-anchor">#</a> 4. 绑定this的方法</h2> <p>this的动态切换，为JavaScript带来了巨大的灵活性，但也使得编程变得困难和模糊。</p> <p>有时需要把this固定下来，免得出现意外情况。</p> <p>JavaScript提供了call、apply、bind三个方法来切换/固定this的指向。</p> <h3 id="_4-1-function-prototype-call"><a href="#_4-1-function-prototype-call" class="header-anchor">#</a> 4.1 Function.prototype.call()</h3> <p>函数实例的call方法，可以指定函数内部this的指向(函数执行时所在的作用域)，然后在指定的作用域中，调用该函数。</p> <ul><li><p>call方法会立即执行函数</p></li> <li><p><code>call</code>方法的参数，应该是一个对象。如果参数为空、<code>null</code>和<code>undefined</code>，则默认传入全局对象。</p></li> <li><p>call方法第一个参数如果是原始类型，则会自动转成对应的包装对象，然后传入call方法中</p></li> <li><p><code>call</code>方法还可以接受多个参数,第一个参数就是<code>this</code>所要指向的那个对象，后面的参数则是函数调用时所需的参数。</p></li> <li><p><code>call</code>方法的一个应用是调用对象的原生方法。</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> n<span class="token operator">:</span> <span class="token number">456</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 		<span class="token comment">// 123</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> 	<span class="token comment">// 123</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// 123</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> 	<span class="token comment">// 123</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> 	<span class="token comment">// 456</span>
<span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 传入了原始类型，自动转为对象。</span>
<span class="token function">f</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>		<span class="token comment">// Number {5}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token comment">// 覆盖掉继承的 hasOwnProperty 方法</span>
obj<span class="token punctuation">.</span><span class="token function-variable function">hasOwnProperty</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token comment">// 将hasOwnProperty方法的原始定义放到obj对象上执行，这样无论obj上有没有同名方法，都不会影响结果。</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'toString'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_4-2-function-prototype-apply"><a href="#_4-2-function-prototype-apply" class="header-anchor">#</a> 4.2 Function.prototype.apply()</h3> <p><code>apply</code>方法的作用与<code>call</code>方法类似，也是改变<code>this</code>指向，然后再调用该函数。唯一的区别就是，它接收一个数组作为函数执行时的参数。</p> <p><code>apply</code>方法的第一个参数也是<code>this</code>所要指向的那个对象，如果设为<code>null</code>或<code>undefined</code>，则等同于指定全局对象。第二个参数则是一个数组，该数组的所有成员依次作为参数，传入原函数。原函数的参数，在<code>call</code>方法中必须一个个添加，但是在<code>apply</code>方法中，必须以数组形式添加。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> 		<span class="token comment">// 2</span>
<span class="token function">f</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 	<span class="token comment">// 2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>利用apply使用数组作为函数参数这一点可以做一些事情：</p> <ul><li><p>找出数组最大元素</p> <p>JS不提供找数组最大元素的函数，使用Math.max和apply方法，就可以返回数组的最大元素：</p></li> <li><p>将数组的空元素变为undefined</p> <p>空元素与<code>undefined</code>的差别在于，数组的<code>forEach</code>方法会跳过空元素，但是不会跳过<code>undefined</code>。因此，遍历内部元素的时候，会得到不同的结果。</p></li> <li><p>转换类似数组的对象</p> <p>这个方法起作用的前提是，被处理的对象必须有<code>length</code>属性，以及相对应的数字键。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// 400</span>
<span class="token function">Array</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>	<span class="token comment">// [ 'a', undefined, 'b' ]</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> length<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// [1]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h3 id="_4-3-function-prototype-bind"><a href="#_4-3-function-prototype-bind" class="header-anchor">#</a> 4.3 Function.prototype.bind()</h3> <p>bind方法用于将函数体内的this绑定到某个对象，然后返回一个新函数。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1524842071860</span>
<span class="token keyword">var</span> print <span class="token operator">=</span> d<span class="token punctuation">.</span>getTime<span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: this is not a Date object.</span>
<span class="token keyword">var</span> print <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1524842071860</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上面的例子中getTime方法内部的this绑定了Data对象的实例，所以会报错，使用bind方法将<code>getTime</code>方法内部的<code>this</code>绑定到<code>d</code>对象，这时就可以安全地将这个方法赋值给其他变量了。</p> <p>也可以绑到其他对象上：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fun <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
counter<span class="token punctuation">.</span>count <span class="token comment">// 1</span>

<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">inc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> func <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>count <span class="token comment">// 101</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>bind</code>还可以接受更多的参数，将这些参数绑定原函数的参数。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m <span class="token operator">+</span> y <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>n<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> m<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> n<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> newAdd <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newAdd</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// 20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面代码中，<code>bind</code>方法除了绑定<code>this</code>对象，还将<code>add</code>函数的第一个参数<code>x</code>绑定成<code>5</code>，然后返回一个新函数<code>newAdd</code>，这个函数只要再接受一个参数<code>y</code>就能运行了。</p> <p>如果<code>bind</code>方法的第一个参数是<code>null</code>或<code>undefined</code>，等于将<code>this</code>绑定到全局对象，函数运行时<code>this</code>指向顶层对象（浏览器为<code>window</code>）。</p> <h4 id="_4-3-1-使用bind方法注意事项"><a href="#_4-3-1-使用bind方法注意事项" class="header-anchor">#</a> 4.3.1 使用bind方法注意事项</h4> <ol><li><p>bind方法不执行函数，会返回一个新函数</p> <p>由于bind方法每次返回一个新函数，所以有的地方需要注意：如监听事件的时候，如果需要取消绑定，那么就需要把bind返回的函数赋值给一个变量，然后在绑定：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> listener <span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 绑定事件</span>
element<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 取消绑定</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>回调函数使用bind解决this指向问题</p> <p>回调函数中如果有this，那么执行回调函数后，this的指向就会改变，可使用bind方法将this绑定：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">inc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">callIt</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token function">callIt</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
counter<span class="token punctuation">.</span>count <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面代码中，<code>callIt</code>方法会调用回调函数。这时如果直接把<code>counter.inc</code>传入，调用时<code>counter.inc</code>内部的<code>this</code>就会指向全局对象。使用<code>bind</code>方法将<code>counter.inc</code>绑定<code>counter</code>以后，就不会有这个问题，<code>this</code>总是指向<code>counter</code>。</p> <p>还有在数组中方法中的回调函数this指向也会改变：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> times<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">print</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>times<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 什么也没有， 数组回调函数里面的this指向Window</span>

obj<span class="token punctuation">.</span><span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>times<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 张三</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>obj.print</code>内部<code>this.times</code>的<code>this</code>是指向<code>obj</code>的，这个没有问题。但是，<code>forEach</code>方法的回调函数内部的<code>this.name</code>却是指向全局对象，导致没有办法取到值。可通过bind绑定。</p></li></ol> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p><a href="http://javascript.ruanyifeng.com/oop/this.html" target="_blank" rel="noopener noreferrer">this关键字 阮一峰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog-demo/doc/js/001-对象原型继承.html" class="prev">
        对象原型继承
      </a></span> <span class="next"><a href="/blog-demo/doc/js/003-数据类型转换.html">
        数据类型转换
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog-demo/assets/js/app.d550568f.js" defer></script><script src="/blog-demo/assets/js/2.9eb2f958.js" defer></script><script src="/blog-demo/assets/js/16.36be232d.js" defer></script>
  </body>
</html>
